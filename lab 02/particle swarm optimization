import random
import numpy as np
def fitness_function(position):
    return np.sum(position ** 2)

def PSO(dimensions, num_particles, max_iterations):
    w = 0.5
    c1 = 0.8
    c2 = 0.9
    swarm = []
    for _ in range(num_particles):
        position = np.random.uniform(-10, 10, dimensions)
        velocity = np.random.uniform(-1, 1, dimensions)
        pbest_position = position.copy()
        pbest_fitness = fitness_function(position)

        swarm.append({
            'position': position,
            'velocity': velocity,
            'pbest_position': pbest_position,
            'pbest_fitness': pbest_fitness
        })
    gbest_position = swarm[0]['pbest_position'].copy()
    gbest_fitness = fitness_function(gbest_position)

    for _ in range(max_iterations):
        for particle in swarm:
            fitness = fitness_function(particle['position'])
            if fitness < particle['pbest_fitness']:
                particle['pbest_fitness'] = fitness
                particle['pbest_position'] = particle['position'].copy()
            if fitness < gbest_fitness:
                gbest_fitness = fitness
                gbest_position = particle['position'].copy()
        for particle in swarm:
            rand1 = random.random()
            rand2 = random.random()

            inertia = w * particle['velocity']
            cognitive = c1 * rand1 * (particle['pbest_position'] - particle['position'])
            social = c2 * rand2 * (gbest_position - particle['position'])

            particle['velocity'] = inertia + cognitive + social
            particle['position'] = particle['position'] + particle['velocity']

    return gbest_position, gbest_fitness
best_position, best_fitness = PSO(dimensions=3, num_particles=30, max_iterations=100)
print("Best Position:", best_position)
print("Best Fitness:", best_fitness)
